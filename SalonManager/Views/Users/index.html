<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>User Management</title>
</head>
<body>
    <h1>User Management</h1>

    <!-- Formulário para criar um usuário -->
    <h2>Create User</h2>
    <form id="createUserForm">
        <label for="name">Name:</label>
        <input type="text" id="name" name="name" required>
        <label for="email">Email:</label>
        <input type="email" id="email" name="email" required>
        <button type="submit">Create</button>
    </form>

    <!-- Lista de usuários -->
    <h2>Users</h2>
    <ul id="userList"></ul>

    <script>
        // Função para fazer requisição HTTP POST para criar um usuário
        async function createUser(event) {
            event.preventDefault();

            const form = event.target;
            const formData = new FormData(form);

            try {
                const response = await fetch('/api/User', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(Object.fromEntries(formData))
                });

                if (!response.ok) {
                    throw new Error('Failed to create user');
                }

                const data = await response.json();
                alert('User created successfully');
                form.reset();
            } catch (error) {
                alert(error.message);
            }
        }

        // Função para carregar a lista de usuários
        async function loadUsers() {
            try {
                const response = await fetch('/api/User');
                const data = await response.json();

                const userListElement = document.getElementById('userList');
                userListElement.innerHTML = '';

                data.forEach(user => {
                    const listItem = document.createElement('li');
                    listItem.textContent = `${user.id}: ${user.name} - ${user.email}`;
                    userListElement.appendChild(listItem);
                });
            } catch (error) {
                alert('Failed to load users');
            }
        }

        // Adicionar um event listener para o formulário de criação de usuário
        document.getElementById('createUserForm').addEventListener('submit', createUser);

        // Carregar a lista de usuários ao carregar a página
        window.addEventListener('load', loadUsers);
    </script>
</body>
</html>